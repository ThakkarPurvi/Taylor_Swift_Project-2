
CREATE DATABASE taylor_swift_project;

USE taylor_swift_project;

CREATE TABLE master_song_list (
	PK_SongID VARCHAR(10) NOT NULL,
    Title VARCHAR(100) NOT NULL,
    Album VARCHAR(30) NOT NULL,
    Spotify_ID VARCHAR (200) NOT NULL,
    CONSTRAINT UNIQUE (Spotify_ID),
    PRIMARY KEY (PK_SongID)
    );
    
INSERT INTO master_song_list (Spotify_ID, Title, Album, PK_SongID) VALUES
	("SOG_RED", "State of Grace (Taylor's Version)", "Red (Taylor's Version)", "r1"),
	("R_RED", "Red (Taylor's Version)", "Red (Taylor's Version)", "r2"),
	("T_RED", "Treacherous (Taylor's Version)", "Red (Taylor's Version)", "r3"),
    ("IKYWT_RED", "I Knew You Were Trouble (Taylor's Version)", "Red (Taylor's Version)", "r4"),
    ("ATW_RED", "All Too Well (Taylor's Version)", "Red (Taylor's Version)", "r5"),
    ("22_RED", "22 (Taylor's Version)", "Red (Taylor's Version)", "r6"),
    ("IAD_RED", "I Almost Do (Taylor's Version)", "Red (Taylor's Version)", "r7"),
    ("WANEGBT_RED", "We Are Never Ever Getting Back Together (Taylor's Version)", "Red (Taylor's Version)", "r8"),
    ("SSS_RED", "Stay Stay Stay (Taylor's Version)", "Red (Taylor's Version)", "r9"),
    ("TLT_RED", "The Last Time (feat. Gary Lightbody of Snow Patrol) (Taylor's Version)", "Red (Taylor's Version)", "r10"),
    ("HG_RED", "Holy Ground (Taylor's Version)", "Red (Taylor's Version)", "r11"), 
    ("SBT_RED", "Sad Beautiful Tragic (Taylor's Version)", "Red (Taylor's Version)", "r12"),
    ("TLO_RED", "The Lucky One (Taylor's Version)", "Red (Taylor's Version)", "r13"),
    ("EHC_RED", "Everything Has Changed (feat. Ed Sheeran) (Taylor's Version)", "Red (Taylor's Version)", "r14"),
    ("S_RED", "Starlight (Taylor's Version)", "Red (Taylor's Version)", "r15"), 
    ("BA_RED", "Begin Again (Taylor's Version)", "Red (Taylor's Version)", "r16"),
    ("TMIK_RED", "The Moment I Knew (Taylor's Version)", "Red (Taylor's Version)", "r17"),
    ("CBBH_RED", "Come Back...Be Here (Taylor's Version)", "Red (Taylor's Version)", "r18"),
    ("GAH_RED", "Girl At Home (Taylor's Version)", "Red (Taylor's Version)", "r19"),
    ("SOGAV_RED", "State of Grace (Acoustic Version) (Taylor's Version)", "Red (Taylor's Version)", "r20"),
    ("RO_RED", "Ronan (Taylor's Version)", "Red (Taylor's Version)", "r21"),
    ("BM_RED", "Better Man (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r22"),
    ("NN_RED", "Nothing New (feat. Phoebe Bridgers) (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r23"),
    ("B_RED", "Babe (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r24"),
    ("MIAB_RED", "Message In A Bottle (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r25"),
    ("IBYTAM_RED", "I Bet You Think About Me (feat. Chris Stapleton) (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r26"),
    ("FW_RED", "Forever Winter (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r27"),
    ("RU_RED", "Run (feat. Ed Sheeran) (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r28"),
    ("TVFN_RED", "The Very First Night (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r29"),
    ("ATW10_RED", "All Too Well (10 Minute Version) (Taylor's Version) (From The Vault)", "Red (Taylor's Version)", "r30"),
    ("FEAR_F", "Fearless (Taylor's Version)", "Fearless (Taylor's Version)", "f1"),
    ("FIF_F", "Fifteen (Taylor's Version)", "Fearless (Taylor's Version)", "f2"), 
    ("LS_F", "Love Story (Taylor's Version)", "Fearless (Taylor's Version)", "f3"),
    ("HS_F", "Hey Stephen (Taylor's Version)", "Fearless (Taylor's Version)", "f4"), 
    ("WH_F", "White Horse (Taylor's Version)", "Fearless (Taylor's Version)", "f5"), 
    ("YBWM_F", "You Belong With Me (Taylor's Version)", "Fearless (Taylor's Version)", "f6"),
    ("B_F", "Breath (feat. Colbie Caillate) (Taylor's Version)", "Fearless (Taylor's Version)", "f7"),
    ("TMW_F", "Tell Me Why (Taylor's Version)", "Fearless (Taylor's Version)", "f8"), 
    ("YNS_F", "You're Not Sorry (Taylor's Version)", "Fearless (Taylor's Version)", "f9"), 
    ("TWILY_F", "They Way I Loved You (Taylor's Version)", "Fearless (Taylor's Version)", "f10"),
    ("FA_F", "Forever & Always (Taylor's Version)", "Fearless (Taylor's Version)", "f11"),
    ("TBD_F", "The Best Day (Taylor's Version)", "Fearless (Taylor's Version)", "f12"),
    ("C_F", "Change (Taylor's Version)", "Fearless (Taylor's Version)", "f13"), 
    ("JTF_F", "Jump Then Fall (Taylor's Version)", "Fearless (Taylor's Version)", "f14"),
    ("U_F", "Untouchable (Taylor's Version)", "Fearless (Taylor's Version)", "f15"),
    ("FAP_F", "Forever & Always (Piano Version) (Taylor's Version)", "Fearless (Taylor's Version)", "f16"), 
    ("CIWTR_F", "Come In With The Rain (Taylor's Version)", "Fearless (Taylor's Version)", "f17"),
    ("S_F", "Superstar (Taylor's Version)", "Fearless (Taylor's Version)", "f18"),
    ("TOSOTD_F", "The Other Side Of The Door (Taylor's Version)", "Fearless (Taylor's Version)", "f19"),
    ("TWAF_F", "Today Was A Fairytale (Taylor's Version)", "Fearless (Taylor's Version)", "f20"),
    ("YAOM_F", "You All Over Me (feat. Maren Morris) (Taylor's Version) (From The Vault)", "Fearless (Taylor's Version)", "f21"),
    ("MPF_F", "Mr Perfectly Fine (Taylor's Version) (From The Vault)", "Fearless (Taylor's Version)", "f22"),
    ("WWH_F", "We Were Happy (Taylor's Version) (From The Vault)", "Fearless (Taylor's Version)", "f23"), 
    ("TW_F", "That's When (feat. Keith Urban) (Taylor's Version) (From The Vault)", "Fearless (Taylor's Version)", "f24"), 
    ("DY_F", "Don't You (Taylor's Version) (From The Vault)", "Fearless (Taylor's Version)", "f25"),
    ("BBB_F", "Bye Bye Baby (Taylor's Version) (From The Vault)", "Fearless (Taylor's Version)", "f26")
    ;
    
INSERT INTO master_song_list (Spotify_ID, Title, Album, PK_SongID) VALUES
("W_E", "willow", "evermore (deluxe version)", "e1"),
("CP_E", "champagne problems", "evermore (deluxe version)", "e2"),
("GR_E", "gold rush", "evermore (deluxe version)", "e3"),
("TTDS_E", "'tis the damn season", "evermore (deluxe version)", "e4"),
("TI_E", "tolerate it", "evermore (deluxe version)", "e5"), 
("NBNC_E", "no body, no crime (feat. HAIM)", "evermore (deluxe version)", "e6"),
("H_E", "happiness", "evermore (deluxe version)", "e7"),
("D_E", "dorothea", "evermore (deluxe version)", "e8"),
("CI_E", "coney island (feat. The National)", "evermore (deluxe version)", "e9"),
("I_E", "ivy", "evermore (deluxe version)", "e10"),
("CLM_E", "cowboy like me", "evermore (deluxe version)", "e11"),
("LSS_2", "long story short", "evermore (deluxe version)", "e12"), 
("M_E", "marjorie", "evermore (deluxe version)", "e13"), 
("C_E", "closure", "evermore (deluxe version)", "e14"),
("E_E", "evermore (feat. Bon Iver)", "evermore (deluxe version)", "e15"),
("RWYLM_E", "right where you left me - bonus track", "evermore (deluxe version)", "e16"),
("ITTG_E", "it's time to go - bonus track", "evermore (deluxe version)", "e17"),
("T1_FO", "the 1", "folklore (deluxe version)", "fo1"), 
("C_FO", "cardigan", "folklore (deluxe version)", "fo2"),
("TLGAD_FO", "the last great american dynasty", "folklore (deluxe version)", "fo3"),
("EX_FO", "exile (feat. Bon Iver)", "folklore (deluxe version)", "fo4"),
("MTR_FO", "my tears ricochet", "folklore (deluxe version)", "fo5"),
("M_FO", "mirrorball", "folklore (deluxe version)", "fo6"), 
("S_FO", "seven", "folklore (deluxe version)", "fo7"),
("A_FO", "august", "folklore (deluxe version)", "fo8"), 
("TIMT_FO", "this is me trying", "folklore (deluxe version)", "fo9"),
("IA_FO", "illicit affairs", "folklore (deluxe version)", "fo10"),
("IS_FO", "invisible string", "folklore (deluxe version)", "fo11"),
("MW_FO", "mad woman", "folklore (deluxe version)", "fo12"),
("E_FO", "epiphany", "folklore (deluxe version)", "fo13"), 
("B_FO", "betty", "folklore (deluxe version)", "fo14"),
("P_FO", "peace", "folklore (deluxe version)", "fo15"),
("H_FO", "hoax", "folklore (deluxe version)", "fo16"),
("TL_FO", "the lakes - bonus track", "folklore (deluxe version)", "fo17")
; 

select * from master_song_list;

CREATE TABLE song_subject (
	SubjectID VARCHAR(10) NOT NULL,
    Subject_description VARCHAR(20),
    PRIMARY KEY (SubjectID)
	);
    
INSERT INTO song_subject (SubjectID, Subject_description) VALUES
("EX", "Ex partner"),
("CP", "Current partner"),
("ND", "Never dated but..."),
("ME", "Me"),
("F", "Friend");

CREATE TABLE Vibe (
VibeID VARCHAR(10) NOT NULL,
Vibe_description VARCHAR(20),
    PRIMARY KEY (VibeID)
	);
  
INSERT INTO Vibe (VibeID, Vibe_description) VALUES
("P", "Possitive"),
("N", "Negative"),
("IC", "It's complicated")
;

CREATE TABLE time (
TimeID VARCHAR(10) NOT NULL,
Time_description VARCHAR(20),
    PRIMARY KEY (TimeID)
	);
    
INSERT INTO Time (TimeID, Time_description) VALUES
("L", "Long"),
("S", "Short")
;


CREATE TABLE Key_words (
FK_SongID varchar(10) NOT NULL,
VibeID VARCHAR(10),
SubjectID VARCHAR (10),
TimeID VARCHAR (10),
FOREIGN KEY (FK_SongID) REFERENCES master_song_list (PK_SongID),
FOREIGN KEY (VibeID) REFERENCES Vibe (VibeID),
FOREIGN KEY (SubjectID) REFERENCES song_subject (SubjectID),
FOREIGN KEY (TimeID) REFERENCES time (TimeID)
);

INSERT INTO Key_words (FK_SongID, VibeID, SubjectID, TimeID) VALUES
("r1", "P", "CP", "L"),
("r1", "P", "CP", "S"),
("r2", "IC", "EX", "L"),
("r2", "IC", "EX", "S"),
("r2", "P", "EX", "L"),
("r2", "P", "EX", "S"),
("r3", "P", "ND", "L"),
("r3", "P", "ND", "S"),
("r3", "P", "CP", "S"),
("r4", "N", "EX", "L"),
("r4", "N", "EX", "S"),
("r4", "N", "ND", "L"),
("r4", "N", "ND", "S"),
("r5", "IC", "EX", "L"),
("r5", "N", "EX", "L"),
("r6", "P", "ME", NULL),
("r6", "P", "F", NULL),
("r7", "IC", "EX", "L"),
("r7", "IC", "ND", "L"),
("r7", "IC", "EX", "S"),
("r8", "N", "EX", "L"),
("r9", "P", "CP", "L"),
("r10", "N", "CP", "L"),
("r10", "N", "ND", "L"),
("r10", "N", "EX", "L"),
("r10", "IC", "EX", "L"),
("r10", "IC", "ND", "L"),
("r11", "P", "CP", "L"),
("r11", "P", "EX", "L"),
("r11", "P", "EX", "S"),
("r12", "IC", "EX", "S"),
("r12", "P", "EX", "S"),
("r12", "IC", "ND", "S"),
("r12", "P", "ND", "S"),
("r13", "P", "F", "S"),
("r13", "P", "F", "L"),
("r14", "P", "CP", "S"),
("r14", "P", "ND", "S"),
("r15", "P", "EX", "S"),
("r15", "P", "EX", "L"),
("r16", "P", "CP", "S"),
("r16", "N", "EX", "L"),
("r16", "N", "EX", "S"),
("r16", "N", "ND", "L"),
("r16", "N", "ND", "S"),
("r17", "N", "CP", "L"),
("r17", "N", "EX", "L"),
("r17", "N", "CP", "S"),
("r17", "N", "EX", "S"),
("r18", "IC", "ND", "S"),
("r18", "IC", "EX", "S"),
("r19", "N", "ND", "S"),
("r20", "P", "CP", "L"),
("r20", "P", "CP", "S"),
("r21", NULL, NULL, NULL),
("r22", "N", "EX", "L"),
("r22", "IC", "EX", "L"),
("r22", "N", "EX", "S"),
("r22", "IC", "EX", "S"),
("r23", NULL, "ME", NULL),
("r24", "N", "EX", "L"),
("r24", "N", "CP", "L"),
("r25", "P", "ND", "S"),
("r26", "N", "EX", "L"),
("r26", "IC", "EX", "L"),
("r27", "IC", "CP", "L"),
("r27", "IC", "EX", "L"),
("r28", "P", "CP", "S"),
("r28", "P", "ND", "L"),
("r28", "P", "ND", "S"),
("r29", "P", "EX", "L"),
("r29", "IC", "ND", "L"),
("r29", "IC", "EX", "L"),
("r29", "P", "ND", "L"),
("r29", "P", "EX", "S"),
("r29", "IC", "ND", "S"),
("r29", "IC", "EX", "S"),
("r29", "P", "ND", "S"),
("r30", "IC", "EX", "L"),
("r30", "N", "EX", "L")
;

INSERT INTO Key_words (FK_SongID, VibeID, SubjectID, TimeID) VALUES
("f1", "P", "ND","S"),
("f1", "P", "CP","S"),
("f2", "N", "ME",NULL),
("f2", "N", "EX","S"),
("f2", NULL, "F",NULL),
("f3", "P", "CP","L"),
("f3", "P", "CP","S"),
("f4", "P", "ND","L"),
("f4", "P", "ND","S"),
("f5", "N", "EX","L"),
("f6", "P", "ND","L"),
("f7", "IC", "EX","L"),
("f8", "N", "EX","L"),
("f8", "N", "ND","L"),
("f8", "N", "CP","L"),
("f9", "N", "EX","L"),
("f9", "N", "CP","L"),
("f10", "IC", "EX","L"),
("f10", "IC", "CP","L"),
("f10", "IC", "EX","S"),
("f10", "IC", "CP","S"),
("f11", "N", "EX","L"),
("f12", "P", "F",NULL),
("f13", "P", "ME",NULL),
("f13", "P", "F",NULL),
("f14", "P", "ND","S"),
("f14", "P", "ND","L"),
("f14", "P", "CP","S"),
("f15", "IC", "ND","L"),
("f15", "P", "ND","L"),
("f16", "N", "EX","L"),
("f17", "IC", "EX","L"),
("f17", "IC", "ND","L"),
("f18", "P", "ND","S"),
("f18", "P", "ND","L"),
("f19", "IC", "CP","L"),
("f19", "IC", "EX","L"),
("f19", "IC", "CP","S"),
("f19", "IC", "EX","S"),
("f20", "P", "CP","S"),
("f20", "P", "ND","S"),
("f20", "P", "ND","L"),
("f21", "N", "EX","S"),
("f21", "N", "EX","L"),
("f21", "N", "ND","L"),
("f22", "N", "EX","L"),
("f22", "N", "EX","S"),
("f23", "P", "EX","L"),
("f23", "IC", "EX","L"),
("f24", "P", "CP","L"),
("f24", "P", "CP","S"),
("f25", "IC", "EX","L"),
("f25", "IC", "EX","S"),
("f26", "IC", "EX","L"),
("f26", "N", "CP","L")
;

INSERT INTO Key_words (FK_SongID, VibeID, SubjectID, TimeID) VALUES
("e1", "P", "CP","S"),
("e1", "P", "ND","S"),
("e2", "IC", "EX","L"),
("e3", "P", "ND","L"),
("e3", "IC", "ND","L"),
("e3", "P", "ND","S"),
("e3", "IC", "ND","S"),
("e4", "IC", "EX","L"),
("e4", "P", "EX","L"),
("e5", "N", "CP","L"),
("e5", "N", "CP","S"),
("e6", NULL, "F",NULL),
("e7", "IC", "EX","L"),
("e8", "P", "EX","L"),
("e8", "P", "ND","L"),
("e8", "P", "EX","S"),
("e8", "P", "ND","S"),
("e9", "IC", "EX","L"),
("e9", "N", "EX","L"),
("e10", "IC", "ND","S"),
("e10", "IC", "ND","L"),
("e11", "IC", "ND","S"),
("e11", "N", "ND","L"),
("e12", "P", "CP","L"),
("e13", NULL, NULL,NULL),
("e14", "N", "EX","L"),
("e14", "N", "EX","S"),
("e14", "N", "ND","L"),
("e15", "IC", "EX","L"),
("e15", "IC", "EX","S"),
("e16", "N", "EX","L"),
("e16", "N", "EX","S"),
("e16", "IC", "EX","L"),
("e17", "N", "CP","L"),
("e17", "N", "CP","S"),
("e17", "IC", "CP","L"),
("e17", "IC", "EX","L")
;

INSERT INTO Key_words (FK_SongID, VibeID, SubjectID, TimeID) VALUES
("fo1", "IC", "EX","L"),
("fo1", "IC", "EX","S"),
("fo1", "P", "EX","L"),
("fo1", "P", "EX","S"),
("fo2", "N", "EX","S"),
("fo2", "IC", "EX","S"),
("fo2", "N", "EX","L"),
("fo2", "IC", "EX","L"),
("fo3", "P", "ME",NULL),
("fo3", "P", "F",NULL),
("fo4", "N", "EX","L"),
("fo5", "N", "EX","L"),
("fo5", "N", "EX","S"),
("fo6", "IC", "ND","S"),
("fo6", NULL, "ME",NULL),
("fo7", NULL, "F",NULL),
("fo8", "N", "ND","L"),
("fo8", "IC", "ND","S"),
("fo8", "N", "ND","S"),
("fo9", "IC", "CP","L"),
("fo9", "IC", "CP","S"),
("fo9", NULL, "ME",NULL),
("fo10", "N", "ND","S"),
("fo10", "IC", "ND","S"),
("fo10", "N", "ND","L"),
("fo10", "IC", "ND","L"),
("fo11", "P", "CP","L"),
("fo12", NULL, "ME",NULL),
("fo12", "N", "EX","S"),
("fo12", "N", "ND","S"),
("fo12", "N", "EX","L"),
("fo12", "N", "ND","L"),
("fo13", NULL, "F",NULL),
("fo14", "P", "EX","S"),
("fo14", "IC", "EX","S"),
("fo15", "P", "CP","L"),
("fo15", "P", "F",NULL),
("fo16", "IC", "EX","S"),
("fo16", "N", "EX","S"),
("fo16", "N", "F",NULL),
("fo16", "IC", "EX","L"),
("fo16", "N", "EX","L"),
("fo17", "P", "CP","L"),
("fo17", NULL, "ME",NULL)
;


select * from key_words;


 -- Beleow select statement returns  random 8 songs where subject = EX and Vibe = It's complicated. 
SELECT m.Title from master_song_list m 
INNER JOIN key_words k on m.PK_SongID=k.FK_SongID 
where k.vibeID  = "N" and k.SubjectID = "ND" and k.TimeID = "S"
ORDER BY RAND() LIMIT 8; 
